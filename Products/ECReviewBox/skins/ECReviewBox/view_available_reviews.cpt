<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
                      "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en" lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eduComponents">

  <body>
    <metal:block fill-slot="css_slot">
      <style type="text/css"
          media="screen"
          tal:content="string: @import url($portal_url/ecabstyles.css);"/>
    </metal:block>

    <metal:main fill-slot="main">
      <div metal:use-macro="here/document_actions/macros/document_actions" />
      <h1 class="documentFirstHeading" tal:content="here/title_or_id"/>
      <a class="link-parent visualNoPrint"
          tal:define="
            parent_url python: here.navigationParent(here, template_id)"
          tal:condition="parent_url"
          tal:attributes="href python: '%s/%s' % (parent_url, template)"
          i18n:domain="plone"
          i18n:translate="go_to_parent_url">
        Up one level
      </a>

      <style type="text/css">
        .rowtoggle{cursor: pointer;}
        .expanded{display: none;}
      </style>

      <dl class="collapsible block">
        <dt class="collapsibleHeader">Your personal review</dt>
        <dd class="collapsibleContent" tal:define="u python: '%s' % user">
          <p tal:condition="python: not here.availableReviews().has_key(u)"
              tal:replace="string: Your submission hasn't been reviewed yet."
          />
          <pre tal:condition="python: here.availableReviews().has_key(u)"
              tal:content="python: here.availableReviews()[u]['review']"
          />
        </dd>
      </dl>
      <dl class="collapsible block collapsedOnLoad">
        <dt class=collapsibleHeader>Other solutions and their reviews</dt>
        <dd class=collapsibleContent>
      <table class="listing"
          tal:define="pairs python: here.availableReviews()">
        <tr>
          <th class=nosort />
          <th class=nosort>Solution</th>
          <th class=nosort>Review</th>
        </tr>
        <tal:omit-tag tal:repeat="pair python: map(
            lambda x: here.availableReviews()[x],
            filter(
              lambda x: x != ('%s' % user),
              here.availableReviews().keys()))">
          <tr tal:define="odd repeat/pair/odd;
                index repeat/pair/index"
              tal:attributes="class python: (odd and 'odd') or 'even'">
            <td class="nosort">
              <img src="treeCollapsed.gif" alt="expand row"
                  tal:attributes="
                    id python: 'reviews-row-%s-toggle' % index;
                    class python: 'rowtoggle kssattr-state-collapsed ' +
                      ('kssattr-index-%s' % index)"/>
            </td>
            <td class=nosort>
              <pre tal:attributes="class python: 'collapsed row%s' % index"
                  tal:content="python: context.gist(pair['solution'])"/>
              <pre tal:attributes="class python: 'expanded row%s' % index"
                  tal:content="python: pair['solution']"/>
            </td>
            <td class=nosort>
              <pre tal:attributes="class python: 'collapsed row%s' % index"
                  tal:content="python: context.gist(pair['review'])"/>
              <pre tal:attributes="class python: 'expanded row%s' % index"
                  tal:content="python: pair['review']"/>
            </td>
          </tr>
        </tal:omit-tag>
      </table>
        </dd>
    </metal:main>

  </body>
</html>

